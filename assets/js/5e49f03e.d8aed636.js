"use strict";(globalThis.webpackChunkneuroscript_docs=globalThis.webpackChunkneuroscript_docs||[]).push([[7746],{1724(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"packages/dependencies","title":"Working with Dependencies","description":"Add, fetch, and use neurons from external packages","source":"@site/docs/packages/dependencies.md","sourceDirName":"packages","slug":"/packages/dependencies","permalink":"/docs/packages/dependencies","draft":false,"unlisted":false,"editUrl":"https://github.com/neuroscript/neuroscript/tree/main/website/docs/packages/dependencies.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Working with Dependencies","description":"Add, fetch, and use neurons from external packages"},"sidebar":"docsSidebar","previous":{"title":"Creating Packages","permalink":"/docs/packages/creating-packages"},"next":{"title":"Publishing and Security","permalink":"/docs/packages/publishing"}}');var r=i(4848),c=i(8453);const o={sidebar_position:3,title:"Working with Dependencies",description:"Add, fetch, and use neurons from external packages"},t="Working with Dependencies",d={},l=[{value:"Adding Dependencies",id:"adding-dependencies",level:2},{value:"Git Dependencies",id:"git-dependencies",level:3},{value:"Path Dependencies",id:"path-dependencies",level:3},{value:"Version Dependencies",id:"version-dependencies",level:3},{value:"Resulting Axon.toml",id:"resulting-axontoml",level:3},{value:"Fetching Dependencies",id:"fetching-dependencies",level:2},{value:"Where Dependencies Go",id:"where-dependencies-go",level:3},{value:"The Lockfile (Axon.lock)",id:"the-lockfile-axonlock",level:2},{value:"Using Neurons from Dependencies",id:"using-neurons-from-dependencies",level:2},{value:"Wildcard Import",id:"wildcard-import",level:3},{value:"Specific Import",id:"specific-import",level:3},{value:"Multiple Imports",id:"multiple-imports",level:3},{value:"Integration with Compile and Validate",id:"integration-with-compile-and-validate",level:2},{value:"Merge Precedence",id:"merge-precedence",level:3},{value:"Discovering Available Neurons",id:"discovering-available-neurons",level:2},{value:"Full Workflow Example",id:"full-workflow-example",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"working-with-dependencies",children:"Working with Dependencies"})}),"\n",(0,r.jsx)(n.p,{children:"NeuroScript packages can depend on other packages distributed as git repositories or local directories. The dependency system handles fetching, caching, version locking, and integration with the compiler."}),"\n",(0,r.jsx)(n.h2,{id:"adding-dependencies",children:"Adding Dependencies"}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"neuroscript add"})," to declare a dependency in your ",(0,r.jsx)(n.code,{children:"Axon.toml"}),":"]}),"\n",(0,r.jsx)(n.h3,{id:"git-dependencies",children:"Git Dependencies"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Add from a git repository\nneuroscript add attention-blocks \\\n  --git "https://github.com/user/attention.git"\n\n# Pin to a specific branch\nneuroscript add attention-blocks \\\n  --git "https://github.com/user/attention.git" \\\n  --branch main\n\n# Pin to a tag\nneuroscript add attention-blocks \\\n  --git "https://github.com/user/attention.git" \\\n  --tag v0.2.0\n\n# Pin to a specific commit\nneuroscript add attention-blocks \\\n  --git "https://github.com/user/attention.git" \\\n  --rev abc123\n'})}),"\n",(0,r.jsx)(n.h3,{id:"path-dependencies",children:"Path Dependencies"}),"\n",(0,r.jsx)(n.p,{children:"For local development, reference packages by filesystem path:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"neuroscript add local-utils --path ../local-utils\n"})}),"\n",(0,r.jsx)(n.p,{children:"Path dependencies are resolved relative to your project root. They are useful when developing multiple packages together."}),"\n",(0,r.jsx)(n.h3,{id:"version-dependencies",children:"Version Dependencies"}),"\n",(0,r.jsx)(n.p,{children:"For future registry support:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'neuroscript add core-primitives --version "^1.0"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"resulting-axontoml",children:"Resulting Axon.toml"}),"\n",(0,r.jsx)(n.p,{children:"After adding dependencies, your manifest will look like:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[dependencies]\nattention-blocks = { git = "https://github.com/user/attention.git", branch = "main" }\nlocal-utils = { path = "../local-utils" }\ncore-primitives = "^1.0"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"fetching-dependencies",children:"Fetching Dependencies"}),"\n",(0,r.jsxs)(n.p,{children:["Run ",(0,r.jsx)(n.code,{children:"neuroscript fetch"})," to download all declared dependencies:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"neuroscript fetch\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Fetching 2 dependencies...\n  \u2713 attention-blocks -> /Users/you/.neuroscript/git/a1b2c3\n  \u2713 local-utils -> /Users/you/projects/local-utils\n\n\u2713 Generated Axon.lock\n\u2713 All dependencies fetched successfully\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"--verbose"})," for detailed output, or ",(0,r.jsx)(n.code,{children:"--update"})," to pull the latest compatible versions:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"neuroscript fetch --verbose\nneuroscript fetch --update\n"})}),"\n",(0,r.jsx)(n.h3,{id:"where-dependencies-go",children:"Where Dependencies Go"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Git dependencies"})," are cloned to ",(0,r.jsx)(n.code,{children:"~/.neuroscript/git/<hash>/"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Path dependencies"})," are resolved in place (no copying)"]}),"\n",(0,r.jsxs)(n.li,{children:["A shared cache at ",(0,r.jsx)(n.code,{children:"~/.neuroscript/"})," avoids redundant clones"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"the-lockfile-axonlock",children:"The Lockfile (Axon.lock)"}),"\n",(0,r.jsxs)(n.p,{children:["After fetching, an ",(0,r.jsx)(n.code,{children:"Axon.lock"})," file is generated that pins exact versions and commit hashes:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'# This file is @generated by neuroscript\n# It is not intended for manual editing\n\nversion = 1\n\n[[package]]\nname = "attention-blocks"\nversion = "0.3.1"\nsource = "git+https://github.com/user/attention.git?rev=abc123"\n\n[[package]]\nname = "local-utils"\nversion = "0.1.0"\nsource = "path+/Users/you/projects/local-utils"\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Commit your lockfile"})," to version control. This ensures everyone on your team builds with the exact same dependency versions."]}),"\n",(0,r.jsx)(n.h2,{id:"using-neurons-from-dependencies",children:"Using Neurons from Dependencies"}),"\n",(0,r.jsxs)(n.p,{children:["Once dependencies are fetched, import their neurons using ",(0,r.jsx)(n.code,{children:"use"})," statements in your ",(0,r.jsx)(n.code,{children:".ns"})," files:"]}),"\n",(0,r.jsx)(n.h3,{id:"wildcard-import",children:"Wildcard Import"}),"\n",(0,r.jsx)(n.p,{children:"Import all exported neurons from a package:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-neuroscript",children:"use attention-blocks,src/*\n\nneuron MyModel(dim, heads):\n    in: [*batch, seq, dim]\n    out: [*batch, seq, dim]\n    graph:\n        in -> MultiHeadAttention(dim, heads) -> out\n"})}),"\n",(0,r.jsx)(n.h3,{id:"specific-import",children:"Specific Import"}),"\n",(0,r.jsx)(n.p,{children:"Import a single neuron by name:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-neuroscript",children:"use attention-blocks,src/CrossAttention\n\nneuron DecoderBlock(dim, heads):\n    in: [*batch, seq, dim]\n    out: [*batch, seq, dim]\n    graph:\n        in -> CrossAttention(dim, heads) -> out\n"})}),"\n",(0,r.jsx)(n.h3,{id:"multiple-imports",children:"Multiple Imports"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-neuroscript",children:"use attention-blocks,src/*\nuse local-utils,src/*\n\nneuron FullModel(dim, heads, expansion):\n    in: [*batch, seq, dim]\n    out: [*batch, seq, dim]\n    graph:\n        in ->\n            MultiHeadAttention(dim, heads)\n            SwiGLU_FFN(dim, expansion)\n            out\n"})}),"\n",(0,r.jsx)(n.h2,{id:"integration-with-compile-and-validate",children:"Integration with Compile and Validate"}),"\n",(0,r.jsxs)(n.p,{children:["The compiler automatically loads dependencies when an ",(0,r.jsx)(n.code,{children:"Axon.lock"})," file is present:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Validates with all dependency neurons available\nneuroscript validate src/model.ns\n\n# Compiles with dependency neurons in scope\nneuroscript compile src/model.ns\n\n# Skip dependency loading (useful for standalone files)\nneuroscript validate src/model.ns --no-deps\nneuroscript compile src/model.ns --no-deps\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The compiler walks up from your input file to find the nearest ",(0,r.jsx)(n.code,{children:"Axon.lock"}),", then loads all declared dependencies into the symbol table before validation and compilation."]}),"\n",(0,r.jsx)(n.h3,{id:"merge-precedence",children:"Merge Precedence"}),"\n",(0,r.jsx)(n.p,{children:"When the same neuron name exists in multiple sources, precedence is:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"User-defined neurons"})," (your ",(0,r.jsx)(n.code,{children:".ns"})," files) - highest priority"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Standard library"})," neurons"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dependency"})," neurons - lowest priority"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This means you can override any dependency or stdlib neuron by defining one with the same name in your project."}),"\n",(0,r.jsx)(n.h2,{id:"discovering-available-neurons",children:"Discovering Available Neurons"}),"\n",(0,r.jsxs)(n.p,{children:["Use the ",(0,r.jsx)(n.code,{children:"list"})," command to explore what neurons are available:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# List all stdlib primitives and composites\nneuroscript list --stdlib\n\n# List neurons from a specific dependency\nneuroscript list --package attention-blocks\n\n# List everything: stdlib + all dependencies\nneuroscript list --available\n\n# List neurons defined in a file\nneuroscript list src/model.ns\n"})}),"\n",(0,r.jsx)(n.h2,{id:"full-workflow-example",children:"Full Workflow Example"}),"\n",(0,r.jsx)(n.p,{children:"Here's a complete example of consuming a package:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# 1. Initialize your project\nneuroscript init my-model --author "You <you@example.com>"\ncd my-model\n\n# 2. Add a dependency\nneuroscript add transformer-blocks \\\n  --git "https://github.com/user/transformer-blocks.git"\n\n# 3. Fetch it\nneuroscript fetch\n\n# 4. See what neurons are available\nneuroscript list --available\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"5. Write your model"})," using imported neurons in ",(0,r.jsx)(n.code,{children:"src/my_model.ns"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-neuroscript",children:"use transformer-blocks,src/*\n\nneuron MyLanguageModel(dim, heads, layers, vocab):\n    in: [*batch, seq]\n    out: [*batch, seq, vocab]\n    graph:\n        in ->\n            Embedding(vocab, dim)\n            PreNormBlock(dim, heads, 4)\n            PreNormBlock(dim, heads, 4)\n            PreNormBlock(dim, heads, 4)\n            LayerNorm(dim)\n            Linear(dim, vocab)\n            out\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"6. Validate and compile:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"neuroscript validate src/my_model.ns\nneuroscript compile src/my_model.ns -o model.py\n"})}),"\n",(0,r.jsx)(n.p,{children:"The compiled Python module will include all necessary imports for both your neurons and the dependency neurons used in the graph."})]})}function p(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453(e,n,i){i.d(n,{R:()=>o,x:()=>t});var s=i(6540);const r={},c=s.createContext(r);function o(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);